@model IEnumerable<Movies>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie and TV Show List</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .movie-details {
            border: 1px solid #ccc;
            border-radius: 10px;
            padding: 20px;
            max-width: 600px;
            margin: auto;
        }

            .movie-details h2 {
                margin-bottom: 10px;
                color: #333;
            }

            .movie-details p {
                margin: 5px 0;
            }

        .label {
            font-weight: bold;
            color: #555;
        }

        .value {
            color: #333;
        }

        .filter-container {
            margin-bottom: 20px;
        }

        .selected-filters {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

            .selected-filters h3 {
                margin: 0;
                font-size: 1.2em;
            }
    </style>
</head>
<body>

    <h1>Movie and TV Show List</h1>

    <div class="filter-container">
        <input type="text" id="titleFilter" placeholder="Search by Title" value="@ViewBag.SearchTitle" />

        <select id="typeFilter">
            <option value="">Select Type</option>
            <option value="Movie" @(ViewBag.SelectedType == "Movie" ? "selected" : "")>Movie</option>
            <option value="TV Show" @(ViewBag.SelectedType == "TV Show" ? "selected" : "")>TV Show</option>
        </select>

        <select id="yearFilter">
            <option value="">Select Release Year</option>
            @foreach (var year in ViewBag.Years)
            {
                <option value="@year" @(ViewBag.SelectedYear == year ? "selected" : "")>@year</option>
            }
        </select>

        <select id="ratingFilter">
            <option value="">Select Rating</option>
            @foreach (var rating in ViewBag.Ratings)
            {
                <option value="@rating" @(ViewBag.SelectedRating == rating ? "selected" : "")>@rating</option>
            }
        </select>

        <button onclick="filterMovies()">Filter</button>
        <button onclick="clearFilters()">Clear Filters</button> <!-- Clear Filters Button -->
    </div>

    <div class="selected-filters">
        <h3>Selected Filters:</h3>
        <p><strong>Title:</strong> @ViewBag.SearchTitle</p>
        <p><strong>Type:</strong> @(string.IsNullOrEmpty(ViewBag.SelectedType) ? "All" : ViewBag.SelectedType)</p>
        <p><strong>Release Year:</strong> @(ViewBag.SelectedYear ?? "All")</p>
        <p><strong>Rating:</strong> @(string.IsNullOrEmpty(ViewBag.SelectedRating) ? "All" : ViewBag.SelectedRating)</p>
    </div>

    @if (!Model.Any())
    {
        <p>No movies or TV shows available to display.</p>
    }
    else
    {
        <div id="movieList">
            @foreach (var movie in Model)
            {
                <div class="movie-details">
                    <h2>@movie.Title (@movie.ReleaseYear)</h2>
                    <p><span class="label">Type:</span> <span class="value">@movie.Type</span></p>
                    <p><span class="label">Director:</span> <span class="value">@movie.Director</span></p>
                    <p><span class="label">Cast:</span> <span class="value">@movie.Cast</span></p>
                    <p><span class="label">Country:</span> <span class="value">@movie.Country</span></p>
                    <p><span class="label">Date Added:</span> <span class="value">@movie.DateAdded</span></p>
                    <p><span class="label">Rating:</span> <span class="value">@movie.Rating</span></p>
                    <p><span class="label">Duration:</span> <span class="value">@movie.Duration</span></p>
                    <p><span class="label">Category:</span> <span class="value">@movie.ListedIn</span></p>
                    <p><span class="label">Description:</span> <span class="value">@movie.Description</span></p>
                </div>
            }
        </div>
    }

    <script>
        function filterMovies() {
            const title = document.getElementById('titleFilter').value;
            const type = document.getElementById('typeFilter').value;
            const year = document.getElementById('yearFilter').value;
            const rating = document.getElementById('ratingFilter').value;

            // Build the query string
            let query = '';
            if (title) {
                query += `searchTitle=${encodeURIComponent(title)}&`;
            }
            if (type) {
                query += `type=${encodeURIComponent(type)}&`;
            }
            if (year) {
                query += `releaseYear=${encodeURIComponent(year)}&`;
            }
            if (rating) {
                query += `rating=${encodeURIComponent(rating)}&`;
            }

            // Redirect to the same page with the query string
            window.location.href = `@Url.Action("Index", "Home")?${query}`;
        }

        function clearFilters() {
            // Redirect to the Index action without any filters
            window.location.href = '@Url.Action("Index", "Home")';
        }
    </script>

</body>
</html>
